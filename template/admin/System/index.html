
<div id="dcMain">
     <div id="urHere">管理中心<b>></b><strong>系统设置</strong> </div>
     <div class="mainBox" style="height:auto!important;height:550px;min-height:550px;">
         <h3><a href="{:url('System/index')}" class="actionBtn">系统设置</a>系统设置</h3>
          <form id="formaddRule"   enctype="multipart/form-data">
               <table width="100%" border="0" cellpadding="8" cellspacing="0" class="tableBasic">
                   <tr>
                       <td width="90" align="right">站点名称</td>
                       <td><input type="text" name="webname" size="30" class="inpMain" /></td>
                   </tr>
                   <tr>
                       <td width="90" align="right">站点域名</td>
                       <td><input type="text" name="com" size="30" class="inpMain" /></td>
                   </tr>
                   <tr>
                       <td width="90" align="right">是否开启评论</td>
                       <td><select name="commentsOn" id="commentsOn">
                            <option value="1">开启</option>
                            <option value="0">不开启</option>
                           </select>
                       <span style="color: red;margin-left: 20px">默认为开启</span></td>
                   </tr>
                   <tr>
                      <td width="90" align="right">屏蔽词汇</td>
                      <td>
                          <textarea id='senswords' rows="5" cols="50" class="inpMain"></textarea>
                          <span style="color: red;margin-left: 20px">词汇间用逗号分隔</span>
                      </td>
                   </tr>
                   <tr>
                      <td width="90" align="right" >ip黑名单</td>
                      <td>
                          <textarea id='filterIp' rows="5" cols="30" class="inpMain"></textarea>
                          <span style="color: red;margin-left: 20px">ip间用逗号分隔</span>
                      </td>
                   </tr>
                   <tr>
                       <td width="90" align="right">首页幻灯片设置</td>
                       <td>
                          <div id="file_upload_image"><img id="upload_org_code_img" width="80px" height="80px" style="display: none;margin-bottom: 10px;" /></div>
                          <div class="uploadify" style="border-bottom: 1px dotted #778899">
                                <input id="uploadify" type="file" multiple="true" value="" class='uploadify-button' />
                                <a href="javascript:$('#uploadify').uploadify('upload')" >现在上传</a> |
                                <a href="javascript:$('#uploadify').uploadify('cancel')" >取消上传</a> 
                                <span style="color: red;margin-left: 20px">支持.gif .jpg .png图像格式，单张图片大小不能超过2M</span>
                          </div>
                          <div id="file_upload_image1"><img id="upload_org_code_img1" width="80px" height="80px" style="display: none;margin-bottom: 10px;" /></div>
                          <div class="uploadify1" style="border-bottom: 1px dotted #778899">
                                <input id="uploadify1" type="file" multiple="true" value="" class='uploadify-button' />
                                <a href="javascript:$('#uploadify1').uploadify('upload')" >现在上传</a> |
                                <a href="javascript:$('#uploadify1').uploadify('cancel')" >取消上传</a> 
                                <span style="color: red;margin-left: 20px">支持.gif .jpg .png图像格式，单张图片大小不能超过2M</span>
                          </div>
                          <div id="file_upload_image2"><img id="upload_org_code_img2" width="80px" height="80px" style="display: none;margin-bottom: 10px;" /></div>
                          <div class="uploadify2" style="border-bottom: 1px dotted #778899">
                                <input id="uploadify2" type="file" multiple="true" value="" class='uploadify-button' />
                                <a href="javascript:$('#uploadify2').uploadify('upload')" >现在上传</a> |
                                <a href="javascript:$('#uploadify2').uploadify('cancel')" >取消上传</a> 
                                <span style="color: red;margin-left: 20px">支持.gif .jpg .png图像格式，单张图片大小不能超过2M</span>
                          </div>
                          <div id="file_upload_image3"><img id="upload_org_code_img3" width="80px" height="80px" style="display: none;margin-bottom: 10px;" /></div>
                          <div class="uploadify3" style="border-bottom: 1px dotted #778899">
                                <input id="uploadify3" type="file" multiple="true" value="" class='uploadify-button' />
                                <a href="javascript:$('#uploadify3').uploadify('upload')" >现在上传</a> |
                                <a href="javascript:$('#uploadify3').uploadify('cancel')" >取消上传</a> 
                                <span style="color: red;margin-left: 20px">支持.gif .jpg .png图像格式，单张图片大小不能超过2M</span>
                          </div>
                          <div id="file_upload_image4"><img id="upload_org_code_img4" width="80px" height="80px" style="display: none;margin-bottom: 10px;" /></div>
                          <div class="uploadify4" style="border-bottom: 1px dotted #778899">
                                <input id="uploadify4" type="file" multiple="true" value="" class='uploadify-button' />
                                <a href="javascript:$('#uploadify4').uploadify('upload')" >现在上传</a> |
                                <a href="javascript:$('#uploadify4').uploadify('cancel')" >取消上传</a> 
                                <span style="color: red;margin-left: 20px">支持.gif .jpg .png图像格式，单张图片大小不能超过2M</span>
                          </div>
                          <div id="displayMsg"></div>
                      </td>
                   </tr>
                   <tr>
                       <td width="90" align="right">友情链接</td>
                       <td><div id="file_upload_logo"><img id="upload_org_code_logo" style="display: none;margin-bottom: 10px;" /></div>
                          <div class="uploadifylogo">
                                <input id="uploadifylogo" type="file" multiple="true" value="" />
                          </div>网址：<input type="text" name="link" size="40" class="inpMain" style="border-bottom: 1px dotted #778899;"/>&nbsp;              
                       <td>
                   </tr>
                   <tr>
                       <td></td>
                       <td>
                           <input type="hidden" name="token" value="21307217" />
                           <input type="hidden" name="imgUrl" value="" />
                           <input type="hidden" name="imgUrl1" value="" />
                           <input type="hidden" name="imgUrl2" value="" />
                           <input type="hidden" name="imgUrl2" value="" />
                           <input type="hidden" name="imgUrl3" value="" />
                           <input type="hidden" name="imgUrllogo" value="" />
                           <input name="submit" class="btn" type="submit" value="提交" />
                       </td>
                   </tr>
               </table>
          </form>
     </div>
</div>
        <!--引入js-->
        <script type="text/javascript" src="__admin__/plugins/jquery-1.8.3.min.js"></script>
        {load href="__admin__/plugins/uploadify/js/jquery.uploadify.min.js" /} 
        <script src="__admin__/plugins/layer/layer.min.js"></script>
        <script type="text/javascript">
            $(function(){
                $("#formaddRule").submit(function(){
                    var datas = $("#formaddRule").serialize();
                    $.post('{:url("Rule/addRule")}',datas,function(data){
                        if (data.status) {
                            layer.msg(data.msg, {icon: 1,time: 1500},function(){
                                window.location.href = data.url;
                            });
                        }else {
                            layer.msg(data.msg, {icon: 2,time: 1500});
                        }

                    },'json');
                    //阻止表单刷新提
                    return false;
                });
                
            $("#function").hide(); //初始化的时候第二个下拉列表隐藏 
                $("#controller").change(function(){ //当第一个下拉列表变动内容时第二个下拉列表将会显示 
                var cname=$("#controller").val(); 
                if(null!= cname && ""!=cname){ 
                    $.get('{:url("Rule/addRule")}',{controllerName:cname},function(data){ 
                        if(data.status){
                            var options=""; 
                            if(data.msg.length>0){    
                                options+="<option value='nal'>-请选择操作-</option>"; 
                                for(var i=0;i<data.msg.length;i++){ 
                                    options+="<option value="+data.msg[i]+">"+data.msg[i]+"</option>"; 
                                } 
                                $("#area").html(options); 
                                $("#function").show(); 
                            } 
                            else if(data.msg.length<=0){ 
                            $("#function").hide(); 
                            } 
                        }
                    }); 
                } 
                else{ 
                $("#function").hide(); 
                } 
            });  
        }); 
        
        $(function(){
                    //swfobject.embedSWF('__admin__/plugins/uploadify/swf/uploadify.swf', "sd_file", "120", "30", "#666");
                    $("#uploadify").uploadify({
                        'swf'           :  '__admin__/plugins/uploadify/swf/uploadify.swf',
                        'uploader'        : '{:url("api/Image/upload")}',
                        'buttonText'      : '第一张图片',  
                        'fileTypeDesc'    : '请选择幻灯图片',  
                        'fileTypeExts'    : '*.gif; *.jpg; *.png',     
                        'fileObjName'     : 'file',
                        'width'           : 80,
                        'height'          : 25,
                        'auto'            : false,
                        'method'          : 'Post',
                        'wmode'           : 'transparent',
                        'multi'          : false,
                        'formData'       : {
				'urlfrom' : 'Huandeng',
                        },
                        'onUploadSuccess' : function(file,data,response) {  
                         if(response){ 
                                var obj =JSON.parse(data);
                                $("#upload_org_code_img").attr("src",obj.src);  
                                $("#file_upload_image").attr("value",obj.src);
                                $("input[name='imgUrl']").attr("value",obj.src)
                                $("#upload_org_code_img").show();  
                            } 
                        }
                    }); 
                    $("#uploadify1").uploadify({
                        'swf'           :  '__admin__/plugins/uploadify/swf/uploadify.swf',
                        'uploader'        : '{:url("api/Image/upload")}',
                        'buttonText'      : '第二张图片',  
                        'fileTypeDesc'    : '请选择幻灯图片',  
                        'fileTypeExts'    : '*.gif; *.jpg; *.png',     
                        'fileObjName'     : 'file',
                        'width'           : 80,
                        'height'          : 25,
                        'auto'            : false,
                        'method'          : 'Post',
                        'wmode'           : 'transparent',
                        'multi'          : false,
                        'formData'       : {
				'urlfrom' : 'Huandeng',
                        },
                        'onUploadSuccess' : function(file,data,response) {  
                         if(response){ 
                                var obj =JSON.parse(data);
                                $("#upload_org_code_img1").attr("src",obj.src);  
                                $("#file_upload_image1").attr("value",obj.src);
                                $("input[name='imgUrl1']").attr("value",obj.src)
                                $("#upload_org_code_img1").show();  
                            } 
                        }
                    }); 
                     $("#uploadify2").uploadify({
                        'swf'           :  '__admin__/plugins/uploadify/swf/uploadify.swf',
                        'uploader'        : '{:url("api/Image/upload")}',
                        'buttonText'      : '第三张图片',  
                        'fileTypeDesc'    : '请选择幻灯图片',  
                        'fileTypeExts'    : '*.gif; *.jpg; *.png',     
                        'fileObjName'     : 'file',
                        'width'           : 80,
                        'height'          : 25,
                        'auto'            : false,
                        'method'          : 'Post',
                        'wmode'           : 'transparent',
                        'multi'          : false,
                        'formData'       : {
				'urlfrom' : 'Huandeng',
                        },
                        'onUploadSuccess' : function(file,data,response) {  
                         if(response){ 
                                var obj =JSON.parse(data);
                                $("#upload_org_code_img2").attr("src",obj.src);  
                                $("#file_upload_image2").attr("value",obj.src);
                                $("input[name='imgUrl2']").attr("value",obj.src)
                                $("#upload_org_code_img2").show();  
                            } 
                        }
                    });
                    
                     $("#uploadify3").uploadify({
                        'swf'           :  '__admin__/plugins/uploadify/swf/uploadify.swf',
                        'uploader'        : '{:url("api/Image/upload")}',
                        'buttonText'      : '第四张图片',  
                        'fileTypeDesc'    : '请选择幻灯图片',  
                        'fileTypeExts'    : '*.gif; *.jpg; *.png',     
                        'fileObjName'     : 'file',
                        'width'           : 80,
                        'height'          : 25,
                        'auto'            : false,
                        'method'          : 'Post',
                        'wmode'           : 'transparent',
                        'multi'           : false,
                        'formData'       : {
				'urlfrom' : 'Huandeng',
                        },
                        'onUploadSuccess' : function(file,data,response) {  
                         if(response){ 
                                var obj =JSON.parse(data);
                                $("#upload_org_code_img3").attr("src",obj.src);  
                                $("#file_upload_image3").attr("value",obj.src);
                                $("input[name='imgUrl3']").attr("value",obj.src)
                                $("#upload_org_code_img3").show();  
                            } 
                        }
                    });
                    
                    $("#uploadify4").uploadify({
                        'swf'           :  '__admin__/plugins/uploadify/swf/uploadify.swf',
                        'uploader'        : '{:url("api/Image/upload")}',
                        'buttonText'      : '第五张图片',  
                        'fileTypeDesc'    : '请选择幻灯图片',  
                        'fileTypeExts'    : '*.gif; *.jpg; *.png',     
                        'fileObjName'     : 'file',
                        'width'           : 80,
                        'height'          : 25,
                        'auto'            : false,
                        'method'          : 'Post',
                        'wmode'           : 'transparent',
                        'multi'          : false,
                        'formData'       : {
				'urlfrom' : 'Huandeng',
                        },
                        'onUploadSuccess' : function(file,data,response) {  
                         if(response){ 
                                var obj =JSON.parse(data);
                                $("#upload_org_code_img4").attr("src",obj.src);  
                                $("#file_upload_image4").attr("value",obj.src);
                                $("input[name='imgUrl4']").attr("value",obj.src)
                                $("#upload_org_code_img4").show();  
                            } 
                        }
                    });
                    
                    $("#uploadifylogo").uploadify({
                        'swf'           :  '__admin__/plugins/uploadify/swf/uploadify.swf',
                        'uploader'        : '{:url("api/Image/upload")}',
                        'buttonText'      : '上传logo',  
                        'fileTypeDesc'    : '请选择logo',  
                        'fileTypeExts'    : '*.gif; *.jpg; *.png',     
                        'fileObjName'     : 'file',
                        'width'           : 80,
                        'height'          : 25,
                        'auto'            : true,
                        'method'          : 'Post',
                        'wmode'           : 'transparent',
                        'multi'          : false,
                        'formData'       : {
				'urlfrom' : 'Logo',
                        },
                        'onUploadSuccess' : function(file,data,response) {  
                         if(response){ 
                                var obj =JSON.parse(data);
                                $("#upload_org_code_logo").attr("src",obj.src);  
                                $("#file_upload_logo").attr("value",obj.src);
                                $("input[name='imgUrllogo']").attr("value",obj.src)
                                $("#upload_org_code_logo").show();  
                            } 
                        }
                    });
            });
        </script>
